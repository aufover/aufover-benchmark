Error: COMPILER_WARNING (CWE-563):
audit-3.0.6/audisp/plugins/remote/audisp-remote.c:1301:13: warning[-Wunused-but-set-variable]: variable 'hver' set but not used
# 1301 |         int hver, mver, rc;
#      |             ^~~~
# 1299|   	OM_uint32 major_status, minor_status;
# 1300|   	gss_buffer_desc utok, etok;
# 1301|-> 	int hver, mver, rc;
# 1302|   	uint32_t type, rlen, seq;
# 1303|   

Error: COMPILER_WARNING (CWE-563):
audit-3.0.6/audisp/plugins/remote/audisp-remote.c:1301:19: warning[-Wunused-but-set-variable]: variable 'mver' set but not used
# 1301 |         int hver, mver, rc;
#      |                   ^~~~
# 1299|   	OM_uint32 major_status, minor_status;
# 1300|   	gss_buffer_desc utok, etok;
# 1301|-> 	int hver, mver, rc;
# 1302|   	uint32_t type, rlen, seq;
# 1303|   

Error: COMPILER_WARNING (CWE-563):
audit-3.0.6/audisp/plugins/remote/audisp-remote.c:1302:18: warning[-Wunused-but-set-variable]: variable 'type' set but not used
# 1302 |         uint32_t type, rlen, seq;
#      |                  ^~~~
# 1300|   	gss_buffer_desc utok, etok;
# 1301|   	int hver, mver, rc;
# 1302|-> 	uint32_t type, rlen, seq;
# 1303|   
# 1304|   	rc = recv_token (sock, &etok);

Error: COMPILER_WARNING (CWE-563):
audit-3.0.6/audisp/plugins/remote/audisp-remote.c: scope_hint: In function 'recv_msg_gss'
audit-3.0.6/audisp/plugins/remote/audisp-remote.c:1302:30: warning[-Wunused-but-set-variable]: variable 'seq' set but not used
# 1302 |         uint32_t type, rlen, seq;
#      |                              ^~~
# 1300|   	gss_buffer_desc utok, etok;
# 1301|   	int hver, mver, rc;
# 1302|-> 	uint32_t type, rlen, seq;
# 1303|   
# 1304|   	rc = recv_token (sock, &etok);

Error: COMPILER_WARNING (CWE-563):
audit-3.0.6/audisp/plugins/remote/audisp-remote.c:1375:13: warning[-Wunused-but-set-variable]: variable 'hver' set but not used
# 1375 |         int hver, mver, rc;
#      |             ^~~~
# 1373|   static int recv_msg_tcp (unsigned char *header, char *msg, uint32_t *mlen)
# 1374|   {
# 1375|-> 	int hver, mver, rc;
# 1376|   	uint32_t type, rlen, seq;
# 1377|   

Error: COMPILER_WARNING (CWE-563):
audit-3.0.6/audisp/plugins/remote/audisp-remote.c:1375:19: warning[-Wunused-but-set-variable]: variable 'mver' set but not used
# 1375 |         int hver, mver, rc;
#      |                   ^~~~
# 1373|   static int recv_msg_tcp (unsigned char *header, char *msg, uint32_t *mlen)
# 1374|   {
# 1375|-> 	int hver, mver, rc;
# 1376|   	uint32_t type, rlen, seq;
# 1377|   

Error: COMPILER_WARNING (CWE-563):
audit-3.0.6/audisp/plugins/remote/audisp-remote.c:1376:18: warning[-Wunused-but-set-variable]: variable 'type' set but not used
# 1376 |         uint32_t type, rlen, seq;
#      |                  ^~~~
# 1374|   {
# 1375|   	int hver, mver, rc;
# 1376|-> 	uint32_t type, rlen, seq;
# 1377|   
# 1378|   	errno = 0;

Error: COMPILER_WARNING (CWE-563):
audit-3.0.6/audisp/plugins/remote/audisp-remote.c: scope_hint: In function 'recv_msg_tcp'
audit-3.0.6/audisp/plugins/remote/audisp-remote.c:1376:30: warning[-Wunused-but-set-variable]: variable 'seq' set but not used
# 1376 |         uint32_t type, rlen, seq;
#      |                              ^~~
# 1374|   {
# 1375|   	int hver, mver, rc;
# 1376|-> 	uint32_t type, rlen, seq;
# 1377|   
# 1378|   	errno = 0;

Error: COMPILER_WARNING (CWE-563):
audit-3.0.6/audisp/plugins/remote/audisp-remote.c:1414:13: warning[-Wunused-but-set-variable]: variable 'hver' set but not used
# 1414 |         int hver, mver;
#      |             ^~~~
# 1412|   {
# 1413|   	unsigned char header[AUDIT_RMW_HEADER_SIZE];
# 1414|-> 	int hver, mver;
# 1415|   	uint32_t type, rlen, seq;
# 1416|   	char msg[MAX_AUDIT_MESSAGE_LENGTH+1];

Error: COMPILER_WARNING (CWE-563):
audit-3.0.6/audisp/plugins/remote/audisp-remote.c:1414:19: warning[-Wunused-but-set-variable]: variable 'mver' set but not used
# 1414 |         int hver, mver;
#      |                   ^~~~
# 1412|   {
# 1413|   	unsigned char header[AUDIT_RMW_HEADER_SIZE];
# 1414|-> 	int hver, mver;
# 1415|   	uint32_t type, rlen, seq;
# 1416|   	char msg[MAX_AUDIT_MESSAGE_LENGTH+1];

Error: COMPILER_WARNING (CWE-563):
audit-3.0.6/audisp/plugins/remote/audisp-remote.c: scope_hint: In function 'check_message_managed'
audit-3.0.6/audisp/plugins/remote/audisp-remote.c:1415:30: warning[-Wunused-but-set-variable]: variable 'seq' set but not used
# 1415 |         uint32_t type, rlen, seq;
#      |                              ^~~
# 1413|   	unsigned char header[AUDIT_RMW_HEADER_SIZE];
# 1414|   	int hver, mver;
# 1415|-> 	uint32_t type, rlen, seq;
# 1416|   	char msg[MAX_AUDIT_MESSAGE_LENGTH+1];
# 1417|   

Error: COMPILER_WARNING (CWE-563):
audit-3.0.6/audisp/plugins/remote/audisp-remote.c:1491:13: warning[-Wunused-but-set-variable]: variable 'hver' set but not used
# 1491 |         int hver, mver;
#      |             ^~~~
# 1489|   	static int sequence_id = 1;
# 1490|   	unsigned char header[AUDIT_RMW_HEADER_SIZE];
# 1491|-> 	int hver, mver;
# 1492|   	uint32_t type, rlen, seq;
# 1493|   	char msg[MAX_AUDIT_MESSAGE_LENGTH+1];

Error: COMPILER_WARNING (CWE-563):
audit-3.0.6/audisp/plugins/remote/audisp-remote.c: scope_hint: In function 'relay_sock_managed'
audit-3.0.6/audisp/plugins/remote/audisp-remote.c:1491:19: warning[-Wunused-but-set-variable]: variable 'mver' set but not used
# 1491 |         int hver, mver;
#      |                   ^~~~
# 1489|   	static int sequence_id = 1;
# 1490|   	unsigned char header[AUDIT_RMW_HEADER_SIZE];
# 1491|-> 	int hver, mver;
# 1492|   	uint32_t type, rlen, seq;
# 1493|   	char msg[MAX_AUDIT_MESSAGE_LENGTH+1];

Error: COMPILER_WARNING (CWE-704):
audit-3.0.6/audisp/plugins/zos-remote/zos-remote-plugin.c: scope_hint: In function 'submission_thread_main'
audit-3.0.6/audisp/plugins/zos-remote/zos-remote-plugin.c:106:30: warning[-Wdiscarded-qualifiers]: passing argument 1 of 'zos_remote_init' discards 'volatile' qualifier from pointer target type
#  106 |         rc = zos_remote_init(&zos_remote_inst, conf.server,
#      |                              ^~~~~~~~~~~~~~~~
audit-3.0.6/audisp/plugins/zos-remote/zos-remote-log.h:27: included_from: Included from here.
audit-3.0.6/audisp/plugins/zos-remote/zos-remote-plugin.c:44: included_from: Included from here.
audit-3.0.6/audisp/plugins/zos-remote/zos-remote-ldap.h:297:21: note: expected 'ZOS_REMOTE *' {aka 'struct opaque *'} but argument is of type 'volatile ZOS_REMOTE *' {aka 'volatile struct opaque *'}
#  297 | int zos_remote_init(ZOS_REMOTE *, const char *, int, const char *,
#      |                     ^~~~~~~~~~~~
#  104|           log_debug("Starting event submission thread");
#  105|           
#  106|->         rc = zos_remote_init(&zos_remote_inst, conf.server, 
#  107|                             conf.port, conf.user,
#  108|                             conf.password,

Error: COMPILER_WARNING (CWE-704):
audit-3.0.6/audisp/plugins/zos-remote/zos-remote-plugin.c:128:39: warning[-Wdiscarded-qualifiers]: passing argument 1 of 'submit_request_s' discards 'volatile' qualifier from pointer target type
#  128 |                 rc = submit_request_s(&zos_remote_inst, ber);
#      |                                       ^~~~~~~~~~~~~~~~
audit-3.0.6/audisp/plugins/zos-remote/zos-remote-log.h:27: included_from: Included from here.
audit-3.0.6/audisp/plugins/zos-remote/zos-remote-plugin.c:44: included_from: Included from here.
audit-3.0.6/audisp/plugins/zos-remote/zos-remote-ldap.h:309:22: note: expected 'ZOS_REMOTE *' {aka 'struct opaque *'} but argument is of type 'volatile ZOS_REMOTE *' {aka 'volatile struct opaque *'}
#  309 | int submit_request_s(ZOS_REMOTE *, BerElement *);
#      |                      ^~~~~~~~~~~~
#  126|                   }
#  127|                   debug_ber(ber);
#  128|->                 rc = submit_request_s(&zos_remote_inst, ber);
#  129|                   if (rc == ICTX_E_FATAL) {
#  130|                           log_err("Error - Fatal error in event submission. Aborting");

Error: COMPILER_WARNING (CWE-704):
audit-3.0.6/audisp/plugins/zos-remote/zos-remote-plugin.c:141:28: warning[-Wdiscarded-qualifiers]: passing argument 1 of 'zos_remote_destroy' discards 'volatile' qualifier from pointer target type
#  141 |         zos_remote_destroy(&zos_remote_inst);
#      |                            ^~~~~~~~~~~~~~~~
audit-3.0.6/audisp/plugins/zos-remote/zos-remote-log.h:27: included_from: Included from here.
audit-3.0.6/audisp/plugins/zos-remote/zos-remote-plugin.c:44: included_from: Included from here.
audit-3.0.6/audisp/plugins/zos-remote/zos-remote-ldap.h:303:25: note: expected 'ZOS_REMOTE *' {aka 'struct opaque *'} but argument is of type 'volatile ZOS_REMOTE *' {aka 'volatile struct opaque *'}
#  303 | void zos_remote_destroy(ZOS_REMOTE *);
#      |                         ^~~~~~~~~~~~
#  139|           }
#  140|           log_debug("Stopping event submission thread");
#  141|->         zos_remote_destroy(&zos_remote_inst);
#  142|           
#  143|           return 0;

Error: COMPILER_WARNING (CWE-704):
audit-3.0.6/auparse/interpret.c: scope_hint: In function 'do_interpret'
audit-3.0.6/auparse/interpret.c:3009:22: warning[-Wdiscarded-qualifiers]: initialization discards 'const' qualifier from pointer target type
# 3009 |         nvlist *nv = &r->nv;
#      |                      ^
# 3007|   const char *do_interpret(const rnode *r, auparse_esc_t escape_mode)
# 3008|   {
# 3009|-> 	nvlist *nv = &r->nv;
# 3010|   	int type;
# 3011|   	idata id;

Error: COMPILER_WARNING (CWE-477):
audit-3.0.6/bindings/python/auparse_python.c: scope_hint: In function 'auparse_callback'
audit-3.0.6/bindings/python/auparse_python.c:294:5: warning[-Wdeprecated-declarations]: 'PyEval_CallObjectWithKeywords' is deprecated
#  294 |     result = PyEval_CallObject(cb->func, arglist);
#      |     ^~~~~~
/usr/include/python3.10/Python.h:130: included_from: Included from here.
audit-3.0.6/bindings/python/auparse_python.c:2: included_from: Included from here.
/usr/include/python3.10/ceval.h:17:43: note: declared here
#   17 | Py_DEPRECATED(3.9) PyAPI_FUNC(PyObject *) PyEval_CallObjectWithKeywords(
#      |                                           ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#  292|   
#  293|       arglist = Py_BuildValue("OiO", cb->py_AuParser, cb_event_type, cb->user_data);
#  294|->     result = PyEval_CallObject(cb->func, arglist);
#  295|       Py_DECREF(arglist);
#  296|       Py_XDECREF(result);

Error: COMPILER_WARNING (CWE-704):
audit-3.0.6/bindings/python/auparse_python.c: scope_hint: In function 'AuParser_init'
audit-3.0.6/bindings/python/auparse_python.c:375:31: warning[-Wdiscarded-qualifiers]: assignment discards 'const' qualifier from pointer target type
#  375 |                 if ((files[i] = PYSTR_ASSTRING(item)) == NULL) {
#      |                               ^
#  373|               for (i = 0; i < n; i++) {
#  374|                   item = PySequence_GetItem(source, i);
#  375|->                 if ((files[i] = PYSTR_ASSTRING(item)) == NULL) {
#  376|                       PyErr_SetString(PyExc_ValueError, "members of source sequence must be a string when source_type is AUSOURCE_FILE_ARRAY");
#  377|                       Py_DECREF(item);

Error: COMPILER_WARNING (CWE-704):
audit-3.0.6/bindings/python/auparse_python.c:418:33: warning[-Wdiscarded-qualifiers]: assignment discards 'const' qualifier from pointer target type
#  418 |                 if ((buffers[i] = PYSTR_ASSTRING(item)) == NULL) {
#      |                                 ^
#  416|               for (i = 0; i < n; i++) {
#  417|                   item = PySequence_GetItem(source, i);
#  418|->                 if ((buffers[i] = PYSTR_ASSTRING(item)) == NULL) {
#  419|                       PyErr_SetString(PyExc_ValueError, "members of source sequence must be a string when source_type is AUSOURCE_BUFFER_ARRAY");
#  420|                       Py_DECREF(item);

Error: COMPILER_WARNING (CWE-681):
audit-3.0.6/lib/gen_tables.c:89:22: warning[-Woverflow]: overflow in conversion from 'long long unsigned int' to 'int' changes value from '4294967296' to '0'
#   89 | #define _S(VAL, S) { (VAL), (S), 0, 0 },
#      |                      ^
audit-3.0.6/auparse/clone-flagtab.h:47:1: note: in expansion of macro '_S'
#   47 | _S(0x100000000ULL,      "CLONE_CLEAR_SIGHAND")
#      | ^~
#   87|   /* The mapping to store. */
#   88|   static struct value values[] = {
#   89|-> #define _S(VAL, S) { (VAL), (S), 0, 0 },
#   90|   #include TABLE_H
#   91|   #undef _S

Error: COMPILER_WARNING (CWE-252):
audit-3.0.6/src/auditd-event.c: scope_hint: In function 'fix_disk_permissions'
audit-3.0.6/src/auditd-event.c:1029:9: warning[-Wunused-result]: ignoring return value of 'chown' declared with attribute 'warn_unused_result'
# 1029 |         chown(dir, 0, config->log_group ? config->log_group : 0);
#      |         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# 1027|   	dir = dirname(path);
# 1028|   	chmod(dir, config->log_group ? S_IRWXU|S_IRGRP|S_IXGRP : S_IRWXU);
# 1029|-> 	chown(dir, 0, config->log_group ? config->log_group : 0);
# 1030|   
# 1031|   	// Now, for each file...

Error: COMPILER_WARNING:
audit-3.0.6/src/auditd-listen.c: scope_hint: In function 'sockaddr_to_addr'
audit-3.0.6/src/auditd-listen.c:124:37: warning[-Wformat-truncation=]: '%s' directive output may be truncated writing up to 45 bytes into a region of size 40
#  103 |         return buf;
#      |                ~~~                   
#......
#  124 |         snprintf(buf, sizeof(buf), "%s:%u",
#      |                                     ^~
audit-3.0.6/src/auditd-listen.c:124:36: note: using the range [0, 4294967295] for directive argument
#  124 |         snprintf(buf, sizeof(buf), "%s:%u",
#      |                                    ^~~~~~~
/usr/include/stdio.h:888: included_from: Included from here.
audit-3.0.6/src/auditd-listen.c:26: included_from: Included from here.
/usr/include/bits/stdio2.h:71:10: note: '__snprintf_chk' output between 3 and 57 bytes into a destination of size 40
#   71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
#      |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#   72 |                                    __glibc_objsize (__s), __fmt,
#      |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#   73 |                                    __va_arg_pack ());
#      |                                    ~~~~~~~~~~~~~~~~~
#  122|   	static char buf[40];
#  123|   
#  124|-> 	snprintf(buf, sizeof(buf), "%s:%u",
#  125|   		sockaddr_to_string(addr),
#  126|   		sockaddr_to_port(addr));

Error: COMPILER_WARNING (CWE-563):
audit-3.0.6/src/auditd-listen.c: scope_hint: In function 'client_ack'
audit-3.0.6/src/auditd-listen.c:500:21: warning[-Wunused-but-set-variable]: variable 'rc' set but not used
#  500 |                 int rc, mlen;
#      |                     ^~
#  498|   		OM_uint32 major_status, minor_status;
#  499|   		gss_buffer_desc utok, etok;
#  500|-> 		int rc, mlen;
#  501|   
#  502|   		mlen = strlen(msg);

Error: COMPILER_WARNING (CWE-563):
audit-3.0.6/src/auditd-listen.c:545:24: warning[-Wunused-but-set-variable]: variable 'mlen' set but not used
#  545 |         uint32_t type, mlen, seq;
#      |                        ^~~~
#  543|   {
#  544|   	unsigned char ch;
#  545|-> 	uint32_t type, mlen, seq;
#  546|   	int hver, mver;
#  547|   

Error: COMPILER_WARNING (CWE-563):
audit-3.0.6/src/auditd-listen.c:546:13: warning[-Wunused-but-set-variable]: variable 'hver' set but not used
#  546 |         int hver, mver;
#      |             ^~~~
#  544|   	unsigned char ch;
#  545|   	uint32_t type, mlen, seq;
#  546|-> 	int hver, mver;
#  547|   
#  548|   	if (AUDIT_RMW_IS_MAGIC (header, length)) {

Error: COMPILER_WARNING (CWE-563):
audit-3.0.6/src/auditd-listen.c: scope_hint: In function 'client_message'
audit-3.0.6/src/auditd-listen.c:546:19: warning[-Wunused-but-set-variable]: variable 'mver' set but not used
#  546 |         int hver, mver;
#      |                   ^~~~
#  544|   	unsigned char ch;
#  545|   	uint32_t type, mlen, seq;
#  546|-> 	int hver, mver;
#  547|   
#  548|   	if (AUDIT_RMW_IS_MAGIC (header, length)) {

Error: COMPILER_WARNING (CWE-563):
audit-3.0.6/src/auditd-listen.c:677:26: warning[-Wunused-but-set-variable]: variable 'type' set but not used
#  677 |                 uint32_t type, len, seq;
#      |                          ^~~~
#  675|   #endif
#  676|   	if (AUDIT_RMW_IS_MAGIC (io->buffer, (io->bufptr+r))) {
#  677|-> 		uint32_t type, len, seq;
#  678|   		int hver, mver;
#  679|   		unsigned char *header = (unsigned char *)io->buffer;

Error: COMPILER_WARNING (CWE-563):
audit-3.0.6/src/auditd-listen.c:677:37: warning[-Wunused-but-set-variable]: variable 'seq' set but not used
#  677 |                 uint32_t type, len, seq;
#      |                                     ^~~
#  675|   #endif
#  676|   	if (AUDIT_RMW_IS_MAGIC (io->buffer, (io->bufptr+r))) {
#  677|-> 		uint32_t type, len, seq;
#  678|   		int hver, mver;
#  679|   		unsigned char *header = (unsigned char *)io->buffer;

Error: COMPILER_WARNING (CWE-563):
audit-3.0.6/src/auditd-listen.c:678:21: warning[-Wunused-but-set-variable]: variable 'hver' set but not used
#  678 |                 int hver, mver;
#      |                     ^~~~
#  676|   	if (AUDIT_RMW_IS_MAGIC (io->buffer, (io->bufptr+r))) {
#  677|   		uint32_t type, len, seq;
#  678|-> 		int hver, mver;
#  679|   		unsigned char *header = (unsigned char *)io->buffer;
#  680|   

Error: COMPILER_WARNING (CWE-563):
audit-3.0.6/src/auditd-listen.c: scope_hint: In function 'auditd_tcp_client_handler'
audit-3.0.6/src/auditd-listen.c:678:27: warning[-Wunused-but-set-variable]: variable 'mver' set but not used
#  678 |                 int hver, mver;
#      |                           ^~~~
#  676|   	if (AUDIT_RMW_IS_MAGIC (io->buffer, (io->bufptr+r))) {
#  677|   		uint32_t type, len, seq;
#  678|-> 		int hver, mver;
#  679|   		unsigned char *header = (unsigned char *)io->buffer;
#  680|   

Error: COMPILER_WARNING:
audit-3.0.6/src/auditd-listen.c: scope_hint: In function 'auditd_tcp_listen_init'
audit-3.0.6/src/auditd-listen.c:973:41: warning[-Wformat-truncation=]: '%lu' directive output may be truncated writing between 1 and 20 bytes into a region of size 16
#  973 |         snprintf(local, sizeof(local), "%lu", config->tcp_listen_port);
#      |                                         ^~~
audit-3.0.6/src/auditd-listen.c:973:40: note: directive argument in the range [1, 18446744073709551615]
#  973 |         snprintf(local, sizeof(local), "%lu", config->tcp_listen_port);
#      |                                        ^~~~~
/usr/include/stdio.h:888: included_from: Included from here.
audit-3.0.6/src/auditd-listen.c:26: included_from: Included from here.
/usr/include/bits/stdio2.h:71:10: note: '__snprintf_chk' output between 2 and 21 bytes into a destination of size 16
#   71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
#      |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#   72 |                                    __glibc_objsize (__s), __fmt,
#      |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#   73 |                                    __va_arg_pack ());
#      |                                    ~~~~~~~~~~~~~~~~~
#  971|   	hints.ai_socktype = SOCK_STREAM;
#  972|   	hints.ai_family = AF_UNSPEC;
#  973|-> 	snprintf(local, sizeof(local), "%lu", config->tcp_listen_port);
#  974|   
#  975|   	rc = getaddrinfo(NULL, local, &hints, &ai);

Error: COMPILER_WARNING:
audit-3.0.6/src/auditd.c: scope_hint: In function 'netlink_handler'
audit-3.0.6/src/auditd.c:488:60: warning[-Wformat-truncation=]: '%s' directive output may be truncated writing up to 4096 bytes into a region of size between 397 and 416
#  488 |                         "op=error-halt auid=%u pid=%d subj=%s res=failed",
#      |                                                            ^~
#  489 |                                                 audit_getloginuid(),
#  490 |                                                 getpid(), subj);
#      |                                                           ~~~~
/usr/include/stdio.h:888: included_from: Included from here.
audit-3.0.6/src/auditd.c:25: included_from: Included from here.
/usr/include/bits/stdio2.h:71:10: note: '__snprintf_chk' output between 44 and 4159 bytes into a destination of size 448
#   71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
#      |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#   72 |                                    __glibc_objsize (__s), __fmt,
#      |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#   73 |                                    __va_arg_pack ());
#      |                                    ~~~~~~~~~~~~~~~~~
#  486|   				if (*subj)
#  487|   					snprintf(emsg, sizeof(emsg),
#  488|-> 			"op=error-halt auid=%u pid=%d subj=%s res=failed",
#  489|   						audit_getloginuid(),
#  490|   						getpid(), subj);

Error: COMPILER_WARNING (CWE-252):
audit-3.0.6/src/auditd.c: scope_hint: In function 'pipe_handler'
audit-3.0.6/src/auditd.c:577:9: warning[-Wunused-result]: ignoring return value of 'read' declared with attribute 'warn_unused_result'
#  577 |         read(pipefds[0], buf, sizeof(buf));
#      |         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#  575|   
#  576|   	// Drain the pipe - won't block because libev sets non-blocking mode
#  577|-> 	read(pipefds[0], buf, sizeof(buf));
#  578|   	enqueue_event(reconfig_ev);
#  579|   	reconfig_ev = NULL;

Error: COMPILER_WARNING (CWE-252):
audit-3.0.6/src/auditd.c: scope_hint: In function 'reconfig_ready'
audit-3.0.6/src/auditd.c:585:9: warning[-Wunused-result]: ignoring return value of 'write' declared with attribute 'warn_unused_result'
#  585 |         write(pipefds[1], msg, strlen(msg));
#      |         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#  583|   {
#  584|   	const char *msg = "ready\n";
#  585|-> 	write(pipefds[1], msg, strlen(msg));
#  586|   }
#  587|   

Error: COMPILER_WARNING:
audit-3.0.6/src/auditd.c: scope_hint: In function 'main'
audit-3.0.6/src/auditd.c:828:33: warning[-Wformat-truncation=]: '%s' directive output may be truncated writing up to 4096 bytes into a region of size between 320 and 383
#  828 |                                 "op=start ver=%s format=%s "
#      |                                 ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
#......
#  833 |                                 getuid(), session,  subj);
#      |                                                     ~~~~
audit-3.0.6/src/auditd.c:830:53: note: format string is defined here
#  830 |                                 "uid=%u ses=%u subj=%s res=success",
#      |                                                     ^~
/usr/include/stdio.h:888: included_from: Included from here.
audit-3.0.6/src/auditd.c:25: included_from: Included from here.
/usr/include/bits/stdio2.h:71:10: note: '__snprintf_chk' output 78 or more bytes (assuming 4237) into a destination of size 448
#   71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
#      |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#   72 |                                    __glibc_objsize (__s), __fmt,
#      |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#   73 |                                    __va_arg_pack ());
#      |                                    ~~~~~~~~~~~~~~~~~
#  826|   		if (getsubj(subj))
#  827|   			snprintf(start, sizeof(start),
#  828|-> 				"op=start ver=%s format=%s "
#  829|   				"kernel=%.56s auid=%u pid=%d "
#  830|   				"uid=%u ses=%u subj=%s res=success",

Error: COMPILER_WARNING (CWE-477):
audit-3.0.6/src/ausearch.c: scope_hint: In function 'process_stdin'
audit-3.0.6/src/ausearch.c:524:13: warning[-Wdeprecated-declarations]: 'siginterrupt' is deprecated: Use sigaction with SA_RESTART instead
#  524 |             siginterrupt(SIGALRM, 1) == -1)
#      |             ^~~~~~~~~~~~
/usr/include/sys/param.h:28: included_from: Included from here.
audit-3.0.6/src/ausearch.c:37: included_from: Included from here.
/usr/include/signal.h:324:12: note: declared here
#  324 | extern int siginterrupt (int __sig, int __interrupt) __THROW
#      |            ^~~~~~~~~~~~
#  522|   
#  523|   	if (signal(SIGALRM, alarm_handler) == SIG_ERR ||
#  524|-> 	    siginterrupt(SIGALRM, 1) == -1)
#  525|   		return -1;
#  526|   

Error: COMPILER_WARNING:
audit-3.0.6/src/libev/ev.c:2146:31: warning: 'ev_default_loop_ptr' initialized and declared 'extern'
# 2146 |   EV_API_DECL struct ev_loop *ev_default_loop_ptr = 0; /* needs to be initialised to make it a definition despite extern */
#      |                               ^~~~~~~~~~~~~~~~~~~
# 2144|   
# 2145|     static struct ev_loop default_loop_struct;
# 2146|->   EV_API_DECL struct ev_loop *ev_default_loop_ptr = 0; /* needs to be initialised to make it a definition despite extern */
# 2147|   
# 2148|   #else

Error: COMPILER_WARNING (CWE-563):
audit-3.0.6/src/libev/ev.c:222: included_from: Included from here.
audit-3.0.6/src/libev/ev_iouring.c: scope_hint: In function 'iouring_fork'
audit-3.0.6/src/libev/ev.h:180:20: warning[-Wunused-value]: left-hand operand of comma expression has no effect
#  180 | # define EV_A_ EV_A,                              /* a loop as first of multiple arguments */
#      |                    ^
audit-3.0.6/src/libev/ev.h:698:52: note: in definition of macro 'ev_io_set'
#  698 | #define ev_io_set(ev,fd_,events_)            do { (ev)->fd = (fd_); (ev)->events = (events_) | EV__IOFDSET; } while (0)
#      |                                                    ^~
audit-3.0.6/src/libev/ev_iouring.c:428:16: note: in expansion of macro 'EV_A_'
#  428 |   ev_io_set   (EV_A_ &iouring_tfd_w, iouring_tfd, EV_READ);
#      |                ^~~~~
#  178|   # define EV_P_ EV_P,                              /* a loop as first of multiple parameters */
#  179|   # define EV_A  loop                               /* a loop as sole argument to a function call */
#  180|-> # define EV_A_ EV_A,                              /* a loop as first of multiple arguments */
#  181|   # define EV_DEFAULT_UC  ev_default_loop_uc_ ()    /* the default loop, if initialised, as sole arg */
#  182|   # define EV_DEFAULT_UC_ EV_DEFAULT_UC,            /* the default loop as first of multiple arguments */

Error: COMPILER_WARNING (CWE-393):
audit-3.0.6/src/libev/ev.c:3108: included_from: Included from here.
audit-3.0.6/src/libev/ev_iouring.c: scope_hint: In function 'iouring_sqe_submit'
audit-3.0.6/src/libev/ev_iouring.c:300:1: warning[-Wreturn-type]: no return statement in function returning non-void
#  300 | }
#      | ^
#  298|     /*ECB_MEMORY_FENCE_RELEASE; * for the time being we assume this is not needed */
#  299|     ++iouring_to_submit;
#  300|-> }
#  301|   
#  302|   /*****************************************************************************/
